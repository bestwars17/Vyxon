--// Vyxon Hub Script (Final)
local lib = loadstring(game:HttpGet("https://raw.githubusercontent.com/bestwars17/Vyxon/refs/heads/main/Library.txt", true))()
local win = lib:AddWindow("Fixed by Vyxon | test hub", {
    main_color = Color3.fromRGB(0, 0, 255),
    min_size = Vector2.new(540, 450),
    can_resize = false,
})

local Players = game:GetService("Players")
local ReplicatedStorage = game:GetService("ReplicatedStorage")
local LocalPlayer = Players.LocalPlayer

--// Rebirth Class
local RB = {}
RB.__index = RB
function RB.new(tab)
    local self = setmetatable({}, RB)
    self.on = false
    self.target = 1
    self.tab = tab
    self:ui()
    return self
end
function RB:ui()
    self.input = self.tab:AddTextBox("Target", function(v)
        local n = tonumber(v)
        if n and n >= 1 then
            self.target = n
        else
            self.input:Set("")
        end
    end, { placeholder = "" })

    self.tab:AddSwitch("Auto Rebirth", function(s)
        self.on = s
        if s then self:run() end
    end)
end
function RB:run()
    task.spawn(function()
        local ls = LocalPlayer:WaitForChild("leaderstats")
        local rb = ls and ls:WaitForChild("Rebirths")
        local evt = ReplicatedStorage:WaitForChild("rEvents")
        local remote = evt and evt:WaitForChild("rebirthRemote")
        if not (rb and remote) then self.on = false return end

        while self.on do
            if rb.Value >= self.target then
                self.on = false break
            end
            pcall(function()
                remote:InvokeServer("rebirthRequest")
            end)
            task.wait(0.2)
        end
    end)
end

--// Tabs
local rebTab = win:AddTab("Rebirth")
local mainTab = win:AddTab("Main")
local killerTab = win:AddTab("Killer")
local statsTab = win:AddTab("Stats")
local farmTab = win:AddTab("Auto Farm")
local serverTab = win:AddTab("Server")
local crystalsTab = win:AddTab("Crystals")

local rebirth = RB.new(rebTab)

--// Main Features
mainTab:AddTextBox("Player Speed", function(val)
    local num = tonumber(val)
    if num and LocalPlayer.Character and LocalPlayer.Character:FindFirstChildOfClass("Humanoid") then
        LocalPlayer.Character.Humanoid.WalkSpeed = num
    end
end, { placeholder = "WalkSpeed" })

mainTab:AddSwitch("Anti Knockback", function(bool)
    local humanoid = LocalPlayer.Character and LocalPlayer.Character:FindFirstChildOfClass("Humanoid")
    if humanoid then
        humanoid:SetAttribute("NoKnockback", bool)
    end
end)

-- Lock Position
local lockedPos = nil
mainTab:AddSwitch("Lock Position", function(bool)
    local hrp = LocalPlayer.Character and LocalPlayer.Character:FindFirstChild("HumanoidRootPart")
    if bool and hrp then
        lockedPos = hrp.CFrame
        task.spawn(function()
            while bool and hrp do
                hrp.CFrame = lockedPos
                task.wait()
            end
        end)
    else
        lockedPos = nil
    end
end)

--// Killer Features
local whitelist = {}
killerTab:AddTextBox("Whitelist User", function(user)
    if user and user ~= "" and not table.find(whitelist, user) then
        table.insert(whitelist, user)
    end
end, { placeholder = "Add Username" })

-- Auto Kill Evil Karma
killerTab:AddSwitch("Kill Evil Karma", function(bool)
    task.spawn(function()
        while bool do
            for _, p in pairs(Players:GetPlayers()) do
                if p ~= LocalPlayer and not table.find(whitelist, p.Name) and p:FindFirstChild("leaderstats") then
                    local karma = p.leaderstats:FindFirstChild("Karma")
                    if karma and karma.Value < 0 then
                        local hrp = p.Character and p.Character:FindFirstChild("HumanoidRootPart")
                        if hrp and LocalPlayer.Character and LocalPlayer.Character:FindFirstChild("HumanoidRootPart") then
                            LocalPlayer.Character.HumanoidRootPart.CFrame = hrp.CFrame * CFrame.new(0,0,3)
                            local tool = LocalPlayer.Character:FindFirstChildOfClass("Tool")
                            if tool then tool:Activate() end
                        end
                    end
                end
            end
            task.wait(0.2)
        end
    end)
end)

-- Auto Kill Good Karma
killerTab:AddSwitch("Kill Good Karma", function(bool)
    task.spawn(function()
        while bool do
            for _, p in pairs(Players:GetPlayers()) do
                if p ~= LocalPlayer and not table.find(whitelist, p.Name) and p:FindFirstChild("leaderstats") then
                    local karma = p.leaderstats:FindFirstChild("Karma")
                    if karma and karma.Value > 0 then
                        local hrp = p.Character and p.Character:FindFirstChild("HumanoidRootPart")
                        if hrp and LocalPlayer.Character and LocalPlayer.Character:FindFirstChild("HumanoidRootPart") then
                            LocalPlayer.Character.HumanoidRootPart.CFrame = hrp.CFrame * CFrame.new(0,0,3)
                            local tool = LocalPlayer.Character:FindFirstChildOfClass("Tool")
                            if tool then tool:Activate() end
                        end
                    end
                end
            end
            task.wait(0.2)
        end
    end)
end)

-- Auto Kill All
killerTab:AddSwitch("Auto Kill All", function(bool)
    task.spawn(function()
        while bool do
            for _, p in pairs(Players:GetPlayers()) do
                if p ~= LocalPlayer and not table.find(whitelist, p.Name) then
                    local hrp = p.Character and p.Character:FindFirstChild("HumanoidRootPart")
                    if hrp and LocalPlayer.Character and LocalPlayer.Character:FindFirstChild("HumanoidRootPart") then
                        LocalPlayer.Character.HumanoidRootPart.CFrame = hrp.CFrame * CFrame.new(0,0,3)
                        local tool = LocalPlayer.Character:FindFirstChildOfClass("Tool")
                        if tool then tool:Activate() end
                    end
                end
            end
            task.wait(0.2)
        end
    end)
end)

--// Auto Farm (Machine + Mob)
local machines = { "Muscle King Bench", "Muscle King Lift", "Muscle King Teleportal" }
local selectedMachine = machines[1]
local selectedMob = nil
local farmingMachine = false
local farmingMob = false

farmTab:AddDropdown("Select Machine", function(opt)
    selectedMachine = opt
end, { default = machines[1], options = machines })

farmTab:AddSwitch("Auto Farm Machine", function(bool)
    farmingMachine = bool
    if bool then
        task.spawn(function()
            while farmingMachine do
                local machine = workspace:FindFirstChild(selectedMachine)
                if machine and LocalPlayer.Character and LocalPlayer.Character:FindFirstChild("HumanoidRootPart") then
                    LocalPlayer.Character.HumanoidRootPart.CFrame = machine.CFrame * CFrame.new(0,0,3)
                    local tool = LocalPlayer.Character:FindFirstChildOfClass("Tool")
                    if tool then tool:Activate() end
                end
                task.wait(0.05)
            end
        end)
    end
end)

farmTab:AddTextBox("Mob Name", function(mobName)
    if mobName and mobName ~= "" then
        selectedMob = mobName
    end
end, { placeholder = "Type Mob Name" })

farmTab:AddSwitch("Auto Farm Mob", function(enabled)
    farmingMob = enabled
    if enabled then
        task.spawn(function()
            while farmingMob and selectedMob do
                for _, mob in pairs(workspace:GetDescendants()) do
                    if mob:IsA("Model") and mob.Name == selectedMob and mob:FindFirstChild("Humanoid") and mob:FindFirstChild("HumanoidRootPart") then
                        local hrp = LocalPlayer.Character and LocalPlayer.Character:FindFirstChild("HumanoidRootPart")
                        if hrp then
                            hrp.CFrame = mob.HumanoidRootPart.CFrame * CFrame.new(0,0,-3)
                            local tool = LocalPlayer.Character:FindFirstChildOfClass("Tool")
                            if tool then tool:Activate() end
                        end
                        task.wait(0.05)
                    end
                end
                task.wait(0.05)
            end
        end)
    end
end)

--// Server Tab Features
serverTab:AddLabel("Fast Features")
serverTab:AddSwitch("Fast Rebirths", function(state)
    getgenv().fastRebirths = state
    task.spawn(function()
        while getgenv().fastRebirths and LocalPlayer.Character do
            ReplicatedStorage.rEvents.rebirthRemote:InvokeServer("rebirthRequest")
            task.wait(0.1)
        end
    end)
end)

serverTab:AddSwitch("Fast Gain", function(state)
    getgenv().fastGain = state
    task.spawn(function()
        while getgenv().fastGain and LocalPlayer.Character do
            ReplicatedStorage.muscleEvent:FireServer("rep")
            task.wait(0.05)
        end
    end)
end)

serverTab:AddSwitch("Hide Frames", function(state)
    getgenv().hideFrames = state
    task.spawn(function()
        while getgenv().hideFrames do
            for _, frame in pairs(game:GetService("CoreGui"):GetDescendants()) do
                if frame:IsA("Frame") then
                    frame.Visible = false
                end
            end
            task.wait(0.1)
        end
    end)
end)
