-- Services
local Players = game:GetService("Players")
local LocalPlayer = Players.LocalPlayer
local ReplicatedStorage = game:GetService("ReplicatedStorage")
local RunService = game:GetService("RunService")
local Workspace = game:GetService("Workspace")

-- Gui Library (Vyxon)
local lib = loadstring(game:HttpGet("https://raw.githubusercontent.com/bestwars17/Vyxon/main/VyxonLib.lua"))()
local win = lib:Window("DEVIL_YOUSSEF | Paid Version")

----------------------------------------------------------------------
-- 📌 Farm++ Tab
----------------------------------------------------------------------

local farmPlusTab = win:Tab("Farm++")

-- ⚡ Auto Rep Farm
farmPlusTab:Toggle("Auto Rep Farm", false, function(state)
    getgenv().AutoRepFarmEnabled = state
    if not state then return end

    local Character = LocalPlayer.Character or LocalPlayer.CharacterAdded:Wait()
    local HumanoidRootPart = Character:WaitForChild("HumanoidRootPart")

    -- إعدادات
    local PET_NAME = "Swift Samurai"
    local ROCK_NAME = "Rock5M"
    local PROTEIN_EGG_NAME = "ProteinEgg"
    local PROTEIN_EGG_INTERVAL = 30 * 60
    local ACTIVE_DURATION = 5
    local REST_DURATION = 2
    local lastProteinEggTime = 0

    -- تجهيز البت
    local function equipPet()
        if LocalPlayer:FindFirstChild("petsFolder") and LocalPlayer.petsFolder:FindFirstChild("Unique") then
            for _, pet in pairs(LocalPlayer.petsFolder.Unique:GetChildren()) do
                if pet.Name == PET_NAME then
                    ReplicatedStorage.rEvents.equipPetEvent:FireServer("equipPet", pet)
                    break
                end
            end
        end
    end

    -- أكل بروتين
    local function eatProteinEgg()
        if LocalPlayer:FindFirstChild("Backpack") then
            for _, item in pairs(LocalPlayer.Backpack:GetChildren()) do
                if item.Name == PROTEIN_EGG_NAME then
                    ReplicatedStorage.rEvents.eatEvent:FireServer("eat", item)
                    break
                end
            end
        end
    end

    -- ضرب الصخرة
    local function hitRock()
        local rock = Workspace:FindFirstChild(ROCK_NAME)
        if rock and HumanoidRootPart then
            HumanoidRootPart.CFrame = rock.CFrame * CFrame.new(0, 0, -5)
            ReplicatedStorage.rEvents.hitEvent:FireServer("hit", rock)
        end
    end

    -- تمرين متواصل
    local function heartbeatBurst(duration)
        local connection
        local startTime = tick()
        connection = RunService.Heartbeat:Connect(function()
            if not getgenv().AutoRepFarmEnabled or tick() - startTime > duration then
                connection:Disconnect()
                return
            end
            if LocalPlayer:FindFirstChild("muscleEvent") then
                LocalPlayer.muscleEvent:FireServer("rep")
            end
        end)
        repeat task.wait() until tick() - startTime > duration or not getgenv().AutoRepFarmEnabled
    end

    -- الحلقة الرئيسية
    task.spawn(function()
        equipPet()
        while getgenv().AutoRepFarmEnabled do
            if tick() - lastProteinEggTime >= PROTEIN_EGG_INTERVAL then
                eatProteinEgg()
                lastProteinEggTime = tick()
            end
            if tick() % 10 < 0.2 then
                hitRock()
            end
            heartbeatBurst(ACTIVE_DURATION)
            task.wait(REST_DURATION)
        end
    end)
end)

-- ⚡ Fast Rebirths
farmPlusTab:Toggle("Fast Rebirths", false, function(state)
    getgenv().FastRebirths = state
    if not state then return end

    task.spawn(function()
        while getgenv().FastRebirths do
            pcall(function()
                ReplicatedStorage.rEvents.rebirthRemote:InvokeServer("rebirthRequest")
            end)
            task.wait(0.1) -- سرعة الريبرث
        end
    end)
end)

----------------------------------------------------------------------
-- ✅ النهاية: Farm++ صار فيه Auto Rep Farm + Fast Rebirths
----------------------------------------------------------------------
